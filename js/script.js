function changeValue(a,b,c){var d;if(c=="users"){d=addSpaces(b.toFixed(0))}if(c=="dollars"){d=b.toFixed(2)}selectors[a].find(".value").text(d)}function changePrice(a,b,c,d,e){var f=0;if(window.timerID){window.clearInterval(window.timerID)}window.timerID=window.setInterval(function(){current_price=easeInOut(a,b,c,f,e);$(document).trigger("price/stock",[{price:current_price}]);f++;if(f>c){window.clearInterval(window.timerID);window.timerID=null}},d)}function easeInOut(a,b,c,d,e){var f=b-a;var g=a+Math.pow(1/c*d,e)*f;return g}function getPrice(){$.ajax({type:"GET",url:"http://finance.google.com/finance/info?client=ig&q=NASDAQ:FB",dataType:"jsonp",success:function(a){$(document).trigger("priceChecked",[{price:a[0].l,time:a[0].ltt}])}})}function calculateUserPrice(a){var b,c;b=a*shares;c=b/users;return c}function addSpaces(a){a+="";x=a.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var b=/(\d+)(\d{3})/;while(b.test(x1)){x1=x1.replace(b,"$1"+" "+"$2")}return x1+x2}var current_price=35,shares=2740000037,users=901e6,timerID,friends=245;var selectors={};$(function(){selectors.stock=$("#stock");selectors.market_cap=$("#market_cap");selectors.user=$("#user");selectors.friends_value=$("#friends_value");selectors.friends=$("#friends");selectors.$time=$("#time");$(document).on("priceChecked",function(a,b){if(b.time&&b.time!=""){var c=(new Date).getSeconds();c=Math.floor(parseInt(c)/5)*5;c=c<10?"0"+c.toString():c;var d=b.time.indexOf("4:00")==-1?b.time.replace(/(AM|PM)/,":"+c):b.time;selectors.$time.text(d)}if(current_price!=b.price){changePrice(current_price,b.price,20,100,2)}});$(document).on("price/stock",function(a,b){changeValue("stock",b.price,"dollars");setTimeout(function(){changeValue("market_cap",b.price*shares,"users")},3e3);var c=calculateUserPrice(b.price);$(document).trigger("price/user",[{price:c}])});$(document).on("price/user",function(a,b){changeValue("user",b.price,"dollars");setTimeout(function(){changeValue("friends_value",friends*b.price,"users")},2e3);setTimeout(function(){changeValue("friends",b.price,"dollars")},1e3)});$(document).trigger("price/stock",[{price:current_price}]);getPrice();setInterval(getPrice,5e3)})